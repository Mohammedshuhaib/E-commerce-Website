<div id="orderlist">


    <table id="myTable" class="table table-responsive">
        <thead>
            <tr>
                <th>Date</th>
                <th>Order ID</th>
                <th>Payment Mode</th>
                <th>Address</th>
                <th>product</th>
                <th>Amount (₹)</th>
                <th>order Status</th>

                {{!-- <th>Product</th>
                <th>Quantity</th> --}}
            </tr>
        </thead>
        <tbody>
            {{#each orders}}
            <tr>
                <td>{{orders.date}}</td>
                <td>{{orders.orderId}}</td>
                <td>{{orders.paymentmethod}}</td>
                <td>
                    <p>Address :</p>
                    <p> {{orders.firstName}} {{orders.lastName}}</p>
                    <p>{{orders.email}} </p>
                    <p>{{orders.phone}} </p>
                    <p> {{orders.address1}},{{orders.addres2}},</p>
                    <p>{{orders.zip}}</p>
                </td>
                <td>
                    <p>Product :</p>
                    <img src="/images/productsImages/{{orders.products.productId}}(1).jpg" width="100">
                    <p>{{orders.products.title}}</p>
                    <p>{{orders.products.quantity}}</p>
                </td>
                <td>₹ {{orders.total}}</td>
                <td>

                    {{#if orders.products.cancelled}}
                    <p>order cancelled</p>
                    {{else}}
                    {{#if orders.products.shipped}}
                    <p>item shipped</p>
                    {{#if orders.products.delivered}}
                    <p>item delivered</p>
                    {{else}}
                    {{!-- <a href="/vendor/orders/deliver/{{orders.products.cart_id}}" class="btn btn-link"> </a>
                    --}}
                    <button onclick="deliver('{{orders.products.cart_id}}')">deliver</button>
                    {{!-- <p class="fw-bold text-success"> deliver</p> --}}

                    {{/if}}
                    {{else}}
                    <button onclick="ship('{{orders.products.cart_id}}')">ship</button>

                    {{/if}}
                    {{/if}}

                </td>
            </tr>
            {{/each}}
        </tbody>
    </table>

</div>



<script>
    document.addEventListener('DOMContentLoaded', function () {
        let table = new DataTable('#myTable');
    });

    function deliver(cartId) {
        console.log(cartId)
        $.ajax({
            url: '/vendor/deliverProduct',
            method: 'post',
            data: {
                cartId: cartId
            },
            success: (response) => {
                if (response.deliver) {
                    $('#orderlist').load(location.href + " #orderlist");
                }
            }
        })
    }
    function ship(cartId) {
        console.log(cartId)
        $.ajax({
            url: '/vendor/shipProduct',
            method: 'post',
            data: {
                cartId: cartId
            },
            success: (response) => {
                if (response.shipped) {
                    $('#orderlist').load(location.href + " #orderlist");
                }
            }
        })
    }

</script>